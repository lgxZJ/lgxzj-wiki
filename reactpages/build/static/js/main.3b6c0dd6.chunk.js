(this["webpackJsonpreact-monitors"]=this["webpackJsonpreact-monitors"]||[]).push([[0],{212:function(e,t,a){e.exports=a(347)},216:function(e,t,a){},217:function(e,t,a){},347:function(e,t,a){"use strict";a.r(t);var r=a(2),l=a.n(r),n=a(21),i=a.n(n),s=(a(216),a(217),a(11)),o=a(12),c=a(14),p=a(13),u=a(49),h=a(61),_=a(60),m=a(351),f=a(38),y=a(353),d=a(350),g=a(73),b=a(43),q=function(e){Object(c.a)(a,e);var t=Object(p.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){var e=this.props.xFieldName,t=this.props.yFieldName,a=this.props.pointsData,r={title:{visible:!1,text:this.props.title},description:{visible:!0,text:this.props.desc},xField:e,yField:t,seriesField:this.props.seriesField,data:a,padding:"auto",forceFit:!0,label:{visible:!0,type:"point"},point:{visible:!0,size:2,shape:"circle",style:{fill:"white",stroke:"#2593fc",lineWidth:1}},legend:{position:"right-top"},yAxis:this.props.yAxis};return l.a.createElement("div",null,l.a.createElement(b.c,r),";")}}]),a}(l.a.Component),v=function(e){Object(c.a)(a,e);var t=Object(p.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){var e=[0,.5,.85,1],t=[];this.props.data.forEach((function(a){t.push({title:a.bulletTitle,measures:[a.bulletMeasure],targets:[85],ranges:e})}));var a={title:{visible:!1,text:this.props.chartTitle},description:{visible:!0,text:this.props.chartDesc},data:t,rangeMax:100,rangeColors:["#B4EBBF","#FFDBA2","#FFB1AC"]};return l.a.createElement(b.a,a)}}]),a}(l.a.Component);function k(){return window.location!==window.parent.location}k()&&(document.domain="lgxzj.wiki");var w=function(){if(k()){var e,t=(e=document.getElementById("root"),Math.max(e.scrollHeight,e.scrollHeight)),a=parent.document.getElementById("ifr");null!==a&&(console.log("changing parent iframe('ifr') to size:",t),a.style.height=t+"px")}else console.log("not inside iframe, no need to change iframe size")},x=(a(157),function(e){Object(c.a)(a,e);var t=Object(p.a)(a);function a(e){var r;return Object(s.a)(this,a),(r=t.call(this,e)).state={curValue:e.curValue,maxValue:e.maxValue,desc:e.desc},r}return Object(o.a)(a,[{key:"render",value:function(){var e={description:{visible:!0,text:this.state.desc},min:0,max:this.state.maxValue,value:this.state.curValue};return l.a.createElement(b.d,e)}}]),a}(l.a.Component)),D=a(352),P=function(e){Object(c.a)(a,e);var t=Object(p.a)(a);function a(e){var r;return Object(s.a)(this,a),(r=t.call(this,e)).state={title:r.props.desc,value:r.props.value},r}return Object(o.a)(a,[{key:"render",value:function(){return l.a.createElement(D.a,this.state)}}]),a}(l.a.Component),j=function(e){Object(c.a)(a,e);var t=Object(p.a)(a);function a(e){var r;return Object(s.a)(this,a),(r=t.call(this,e)).state={title:e.chartTitle,desc:e.desc,data:e.data},r}return Object(o.a)(a,[{key:"render",value:function(){var e={forceFit:!0,title:{visible:!0,text:this.state.title},description:{visible:!0,text:this.state.desc},radius:.8,data:this.state.data,angleField:"value",colorField:"type",label:{visible:!0,type:"spider"}};return l.a.createElement(b.e,e)}}]),a}(l.a.Component),T=function(e){Object(c.a)(a,e);var t=Object(p.a)(a);function a(e){var r;return Object(s.a)(this,a),(r=t.call(this,e)).state=Object(h.a)({},e),r}return Object(o.a)(a,[{key:"render",value:function(){var e={description:{visible:!0,text:this.state.desc},forceFit:!0,data:this.state.data,padding:"auto",xField:"name",yField:"value",meta:{name:{alias:"\u5907\u4efd"},value:{alias:"\u503c"}},label:{visible:!0,position:"middle"}};return l.a.createElement(b.b,e)}}]),a}(l.a.Component),F=m.a.Panel,z=a(295).default,E=function(e){Object(c.a)(a,e);var t=Object(p.a)(a);function a(e){var r;return Object(s.a)(this,a),(r=t.call(this,e)).state=e,r.fetchData=r.fetchData.bind(Object(_.a)(r)),r.fetchCpuData=r.fetchCpuData.bind(Object(_.a)(r)),r.genQueryTimeRange=r.genQueryTimeRange.bind(Object(_.a)(r)),r.panelChanged=r.panelChanged.bind(Object(_.a)(r)),r}return Object(o.a)(a,[{key:"panelChanged",value:function(){setTimeout(w,500)}},{key:"genQueryTimeRange",value:function(){var e=Math.floor(Date.now()/1e3);return{start:e-5,end:e,step:"1s"}}},{key:"rowIdx2Key",value:function(e){return"row_"+e.toString()}},{key:"unixTimestamp2DateFormat",value:function(e){return new Date(1e3*e).Format("HH:mm:ss")}},{key:"stringValue2Int",value:function(e){return parseInt(e)}},{key:"getResultFromResponse",value:function(e){return e.data.data.result}},{key:"updateChartData2State",value:function(e,t,a,r,l){this.setState((function(e){var a=JSON.parse(JSON.stringify(e)),n=a.chartDataArray[t].chartConfigs[r];return n.pointsData=l,n.loading=!1,a}))}},{key:"updateChartLoading2State",value:function(e,t,a,r,l){this.setState((function(e){var a=JSON.parse(JSON.stringify(e));return a.chartDataArray[t].chartConfigs[r].loading=l,a}))}},{key:"fetchCpuData",value:function(e,t,a,r){var l=this,n=this.genQueryTimeRange(),i=this.state.chartDataArray[t].chartConfigs[r].queryUrl;this.updateChartLoading2State(e,t,a,r,!0),z.get(i,{params:Object(h.a)(Object(h.a)({},n),{},{query:'100 - (irate(node_cpu_seconds_total{mode="idle"}[15s]) * 100)'})}).then((function(n){var i=l.getResultFromResponse(n),s=[];i.forEach((function(e,t){var a=e.values,r=e.metric.cpu;a.forEach((function(e){var t,a=l.unixTimestamp2DateFormat(e[0]),n=l.stringValue2Int(e[1]);s.push((t={},Object(u.a)(t,l.state.xFieldName,a),Object(u.a)(t,l.state.yFieldName,n),Object(u.a)(t,l.state.seriesField,"cpu"+r),t))}))})),l.updateChartData2State(e,t,a,r,s)})).catch((function(e){console.log("get node metrics failed",e)}))}},{key:"fetchDataParallel",value:function(e,t,a,r,l,n,i,s){var o=this,c=this.genQueryTimeRange(),p=this.state.chartDataArray[t].chartConfigs[r],_=p.queryUrl;this.updateChartLoading2State(e,t,a,r,!0);var m=[];l.forEach((function(e){m.push(z.get(_,{params:Object(h.a)(Object(h.a)({},c),{},{query:e.query})}))}));var f=function(e,t,a,r,s){var c;null!=n&&(s=n(s));var h=l[t].label;if(null!=i){var _=i(e);null!=_&&(null!=h&&0!==h.length&&(h+="_"),h+=_)}switch(p.chartType){case"bullet":return{bulletTitle:a,bulletMeasure:s};case"line":return c={},Object(u.a)(c,o.state.xFieldName,r),Object(u.a)(c,o.state.yFieldName,s),Object(u.a)(c,o.state.seriesField,h),c;case"column":return{name:h,value:s};case"liquid":return{curValue:s,maxValue:p.maxValue};case"statistics":return{value:s};case"pie":return{type:h,value:s};default:throw"unexpected chart type:"+p.chartType}};Promise.all(m).then((function(l){var n=[];l.forEach((function(e,t){o.getResultFromResponse(e).forEach((function(e){if("proc_top_cpu"===p.type||"proc_top_mem"===p.type||"nginx_http_req_status_metric.lgxzj.wiki"===p.type||"nginx_http_req_status_react.lgxzj.wiki"===p.type||"nginx_http_req_status_www.lgxzj.wiki"===p.type||"phpfpm_wordpress_total_conns"===p.type||"phpfpm_wordpress_start_time"===p.type||"phpfpm_wordpress_max_active_proc"===p.type||"phpfpm_wordpress_proc_threshold_times"===p.type||"phpfpm_sql_total_conns"===p.type||"phpfpm_sql_start_time"===p.type||"phpfpm_sql_max_active_proc"===p.type||"phpfpm_sql_proc_threshold_times"===p.type||"phpfpm_sql_req_slow"===p.type||"backup_mysql_size"===p.type||"backup_wordpress_size"===p.type||"backup_mysql_duration"===p.type||"backup_wordpress_duration"===p.type||"backup_mysql_timestamp"===p.type||"backup_wordpress_timestamp"===p.type){var a=e.metric.proc,r=o.unixTimestamp2DateFormat(e.value[0]),l=parseFloat(e.value[1]);n.push(f(e,t,a,r,l))}else{var i=e.values;i.forEach((function(a){var r=o.unixTimestamp2DateFormat(a[0]),l=null;null==s?l=o.stringValue2Int(a[1]):(l=s(a[1]),console.log("--",l)),n.push(f(e,t,null,r,l))}))}}))})),"proc_top_cpu"!==p.type&&"proc_top_mem"!==p.type&&"nginx_http_req_status_metric.lgxzj.wiki"!==p.type&&"nginx_http_req_status_react.lgxzj.wiki"!==p.type&&"nginx_http_req_status_www.lgxzj.wiki"!==p.type&&"phpfpm_wordpress_total_conns"!==p.type&&"phpfpm_wordpress_start_time"!==p.type&&"phpfpm_wordpress_max_active_proc"!==p.type&&"phpfpm_wordpress_proc_threshold_times"!==p.type&&"phpfpm_sql_total_conns"!==p.type&&"phpfpm_sql_start_time"!==p.type&&"phpfpm_sql_max_active_proc"!==p.type&&"phpfpm_sql_proc_threshold_times"!==p.type&&"phpfpm_sql_req_slow"!==p.type||(console.log("before update",n),n.sort((function(e,t){return parseInt(t.bulletMeasure)-parseInt(e.bulletMeasure)})),console.log("after update",n)),o.updateChartData2State(e,t,a,r,n)})).catch((function(e){console.log("get metrics failed",e)}))}},{key:"fetchMemDataParallel",value:function(e,t,a,r,l){this.fetchDataParallel(e,t,a,r,l,(function(e){return Math.floor(e/1024/1024)}),null)}},{key:"fetchMemData",value:function(e,t,a,r){this.fetchMemDataParallel(e,t,a,r,[{query:"node_memory_MemTotal_bytes",label:"mem_total"},{query:"node_memory_MemFree_bytes",label:"mem_free"}],[])}},{key:"fetchDiskIODataParallel",value:function(e,t,a,r,l){this.fetchDataParallel(e,t,a,r,l,null,(function(e){return null!=e.metric.device?e.metric.device:null}))}},{key:"fetchDiskIOData",value:function(e,t,a,r){this.fetchDiskIODataParallel(e,t,a,r,[{query:"irate(node_disk_written_bytes_total[15s])",label:"written"},{query:"irate(node_disk_read_bytes_total[15s])",label:"read"},{query:"irate(node_textfile_scrape_error[15s])",label:"open_err"}])}},{key:"fetchNetworkIOData",value:function(e,t,a,r){this.fetchDataParallel(e,t,a,r,[{query:"irate(node_network_receive_bytes_total[15s])",label:"recv"},{query:"irate(node_network_receive_errs_total[15s])",label:"recv_err"},{query:"irate(node_network_transmit_bytes_total[15s])",label:"sent"},{query:"irate(node_network_transmit_errs_total[15s])",label:"sent_err"}],(function(e){return Math.floor(e/1024)}),(function(e){return e.metric.device}))}},{key:"fetchProcCpuTopData",value:function(e,t,a,r){this.fetchDataParallel(e,t,a,r,[{query:"ps_pusher_cpu",label:""}],(function(e){return e}),null)}},{key:"fetchProcMemTopData",value:function(e,t,a,r){this.fetchDataParallel(e,t,a,r,[{query:"ps_pusher_mem",label:""}],(function(e){return e}),null)}},{key:"fetchMysqlConnStats",value:function(e,t,a,r){this.fetchDataParallel(e,t,a,r,[{query:"mysql_global_variables_max_connections",label:"max_limit_conn"},{query:"mysql_global_status_threads_connected",label:"cur_active_conn"},{query:"mysql_global_status_max_used_connections",label:"max_used_conn"},{query:"mysql_global_status_threads_connected",label:"opened_conn"}],(function(e){return e}),null)}},{key:"fetchMysqlConnError",value:function(e,t,a,r){this.fetchDataParallel(e,t,a,r,[{query:"irate(mysql_global_status_connection_errors_total[15s])",label:"err_rate"}],(function(e){return e}),(function(e){return e.metric.error}),(function(e){return parseFloat(parseFloat(e).toFixed(1))}))}},{key:"fetchMysqlTpsQps",value:function(e,t,a,r){this.fetchDataParallel(e,t,a,r,[{query:'irate(mysql_global_status_commands_total{command=~"(commit)"}[15s])',label:"tps_commit"},{query:'irate(mysql_global_status_commands_total{command=~"(rollback)"}[15s])',label:"tps_rollback"},{query:"sum(irate(mysql_global_status_commands_total[15s]))",label:"qps_all"}],(function(e){return e}),null,(function(e){return parseFloat(parseFloat(e).toFixed(1))}))}},{key:"fetchMysqlQuerySlow",value:function(e,t,a,r){this.fetchDataParallel(e,t,a,r,[{query:"irate(mysql_global_status_slow_queries[15s])",label:"query_slow"}],(function(e){return e}),null,(function(e){return parseFloat(parseFloat(e).toFixed(1))}))}},{key:"fetchMysqlSlowThreshold",value:function(e,t,a,r){this.fetchDataParallel(e,t,a,r,[{query:"mysql_global_variables_long_query_time",label:"threshold"}],(function(e){return e}),null,(function(e){return parseFloat(parseFloat(e).toFixed(1))}))}},{key:"fetchMysqlBufferPoolPages",value:function(e,t,a,r){this.fetchDataParallel(e,t,a,r,[{query:"mysql_global_status_buffer_pool_pages",label:"pages"}],(function(e){return e}),(function(e){return e.metric.state}),(function(e){return parseFloat(parseFloat(e).toFixed(1))}))}},{key:"fetchMysqlBufferPoolHits",value:function(e,t,a,r){this.fetchDataParallel(e,t,a,r,[{query:"irate(mysql_global_status_innodb_buffer_pool_read_requests[15s])",label:"hits_per_sec"},{query:"irate(mysql_global_status_innodb_buffer_pool_reads[15s])",label:"non_hits_per_sec"}],(function(e){return e}),null,(function(e){return parseFloat(parseFloat(e).toFixed(1))}))}},{key:"fetchMysqlBufferPageSize",value:function(e,t,a,r){this.fetchDataParallel(e,t,a,r,[{query:"mysql_global_status_innodb_page_size",label:"page_size"}],(function(e){return e}),null,(function(e){return parseFloat(parseFloat(e).toFixed(1))}))}},{key:"fetchMysqlBufferPoolSize",value:function(e,t,a,r){this.fetchDataParallel(e,t,a,r,[{query:"mysql_global_variables_innodb_buffer_pool_size",label:"page_size"}],(function(e){return e}),null,(function(e){return parseFloat(parseFloat(e).toFixed(1))}))}},{key:"fetchPhpfpmPoolProcThresholdTimes",value:function(e,t,a,r,l){var n=[{query:'phpfpm_max_children_reached{pool="'+l+'"}',label:"proc_thresold_times"}];this.fetchDataParallel(e,t,a,r,n,(function(e){return e}),null,(function(e){return parseInt(e)}))}},{key:"fetchPhpfpmPoolMacActiveProc",value:function(e,t,a,r,l){var n=[{query:'phpfpm_max_active_processes{pool="'+l+'"}',label:"max_active_proc"}];this.fetchDataParallel(e,t,a,r,n,(function(e){return e}),null,(function(e){return parseInt(e)}))}},{key:"fetchPhpfpmPoolConns",value:function(e,t,a,r,l){var n=[{query:'phpfpm_accepted_connections{pool="'+l+'"}',label:"total_conns"}];this.fetchDataParallel(e,t,a,r,n,(function(e){return e}),null,(function(e){return parseInt(e)}))}},{key:"fetchPhpfpmPoolReqSlow",value:function(e,t,a,r,l){var n=[{query:'phpfpm_slow_requests{pool="'+l+'"}',label:"slow_req"}];this.fetchDataParallel(e,t,a,r,n,(function(e){return e}),null,(function(e){return parseInt(e)}))}},{key:"fetchBackupSize",value:function(e,t,a,r,l){var n=[{query:'lgxzj_backup_size_total{file=~"'+l+'.+"}',label:""}];this.fetchDataParallel(e,t,a,r,n,(function(e){return Math.floor(e/1024)}),(function(e){return e.metric.file}),(function(e){return parseInt(e)}))}},{key:"fetchBackupDuration",value:function(e,t,a,r,l){var n=[{query:'lgxzj_backup_duration_total{file=~"'+l+'.+"}',label:""}];this.fetchDataParallel(e,t,a,r,n,(function(e){return e}),(function(e){return e.metric.file}),(function(e){return parseInt(e)}))}},{key:"fetchBackupTimestamp",value:function(e,t,a,r,l){var n=[{query:'lgxzj_backup_timestamps_total{file=~"'+l+'.+"}',label:""}];this.fetchDataParallel(e,t,a,r,n,(function(e){return e}),(function(e){return e.metric.file}),(function(e){return parseInt(e)}))}},{key:"fetchPhpfpmPoolReqLatency",value:function(e,t,a,r,l){var n=[{query:'phpfpm_process_request_duration{pool="'+l+'"}',label:"pidhash"}];this.fetchDataParallel(e,t,a,r,n,(function(e){return e}),(function(e){return e.metric.pid_hash}),(function(e){return parseInt(e)}))}},{key:"fetchPhpfpmPoolProcess",value:function(e,t,a,r,l){var n=[{query:'phpfpm_active_processes{pool="'+l+'"}',label:"active"},{query:'phpfpm_idle_processes{pool="'+l+'"}',label:"idle"},{query:'phpfpm_total_processes{pool="'+l+'"}',label:"total"}];this.fetchDataParallel(e,t,a,r,n,(function(e){return e}),null,(function(e){return parseInt(e)}))}},{key:"fetchPhpfpmPoolStartTime",value:function(e,t,a,r,l){var n=[{query:'phpfpm_start_since{pool="'+l+'"}',label:"start_time"}];this.fetchDataParallel(e,t,a,r,n,(function(e){return Math.floor(e/60)}),null,(function(e){return parseInt(e)}))}},{key:"fetchNginxHttpStatus",value:function(e,t,a,r,l){var n=[{query:'nginx_http_requests_total{host="'+l+'"}',label:"http"}];this.fetchDataParallel(e,t,a,r,n,(function(e){return e}),(function(e){return e.metric.status}),(function(e){return parseInt(e)}))}},{key:"fetchMysqlCommandQps",value:function(e,t,a,r){this.fetchDataParallel(e,t,a,r,[{query:'irate(mysql_global_status_commands_total{command=~"(select)"}[15s])',label:"qps_select"},{query:'irate(mysql_global_status_commands_total{command=~"(delete)"}[15s])',label:"qps_delete"},{query:'irate(mysql_global_status_commands_total{command=~"(update)"}[15s])',label:"qps_update"},{query:'irate(mysql_global_status_commands_total{command=~"(insert)"}[15s])',label:"qps_insert"}],(function(e){return e}),null,(function(e){return parseFloat(parseFloat(e).toFixed(1))}))}},{key:"fetchDiskCapacityData",value:function(e,t,a,r){this.fetchDataParallel(e,t,a,r,[{query:"node_filesystem_size_bytes",label:"size_total"},{query:"node_filesystem_size_bytes-node_filesystem_avail_bytes",label:"size_used"}],(function(e){return Math.floor(e/1024/1024/1024)}),(function(e){return e.metric.device}))}},{key:"fetchData",value:function(){var e=this;this.state.chartDataArray.forEach((function(t,a){var r=t.chartConfigs;r.forEach((function(t,l){switch(t.type){case"cpu":e.fetchCpuData(r,a,t,l);break;case"mem":e.fetchMemData(r,a,t,l);break;case"disk_io":e.fetchDiskIOData(r,a,t,l);break;case"disk_cap":e.fetchDiskCapacityData(r,a,t,l);break;case"net_io":e.fetchNetworkIOData(r,a,t,l);break;case"proc_top_cpu":e.fetchProcCpuTopData(r,a,t,l);break;case"proc_top_mem":e.fetchProcMemTopData(r,a,t,l);break;case"mysql_conn_stats":e.fetchMysqlConnStats(r,a,t,l);break;case"mysql_conn_err":e.fetchMysqlConnError(r,a,t,l);break;case"mysql_tps_qps":e.fetchMysqlTpsQps(r,a,t,l);break;case"mysql_command_qps":e.fetchMysqlCommandQps(r,a,t,l);break;case"mysql_query_slow":e.fetchMysqlQuerySlow(r,a,t,l);break;case"mysql_slow_threshold":e.fetchMysqlSlowThreshold(r,a,t,l);break;case"mysql_buffer_pool_pages":e.fetchMysqlBufferPoolPages(r,a,t,l);break;case"mysql_buffer_pool_hits":e.fetchMysqlBufferPoolHits(r,a,t,l);break;case"mysql_buffer_pool_page_size":e.fetchMysqlBufferPageSize(r,a,t,l);break;case"mysql_buffer_pool_size":e.fetchMysqlBufferPoolSize(r,a,t,l);break;case"nginx_http_req_status_metric.lgxzj.wiki":e.fetchNginxHttpStatus(r,a,t,l,"metric.lgxzj.wiki");break;case"nginx_http_req_status_react.lgxzj.wiki":e.fetchNginxHttpStatus(r,a,t,l,"react.lgxzj.wiki");break;case"nginx_http_req_status_www.lgxzj.wiki":e.fetchNginxHttpStatus(r,a,t,l,"www.lgxzj.wiki");break;case"phpfpm_wordpress_total_conns":e.fetchPhpfpmPoolConns(r,a,t,l,"wordpress");break;case"phpfpm_wordpress_start_time":e.fetchPhpfpmPoolStartTime(r,a,t,l,"wordpress");break;case"phpfpm_wordpress_max_active_proc":e.fetchPhpfpmPoolMacActiveProc(r,a,t,l,"wordpress");break;case"phpfpm_wordpress_proc_threshold_times":e.fetchPhpfpmPoolProcThresholdTimes(r,a,t,l,"wordpress");break;case"phpfpm_wordpress_process":e.fetchPhpfpmPoolProcess(r,a,t,l,"wordpress");break;case"phpfpm_wordpress_req_latency":e.fetchPhpfpmPoolReqLatency(r,a,t,l,"wordpress");break;case"phpfpm_wordpress_req_slow":e.fetchPhpfpmPoolReqSlow(r,a,t,l,"wordpress");break;case"phpfpm_sql_total_conns":e.fetchPhpfpmPoolConns(r,a,t,l,"sql");break;case"phpfpm_sql_start_time":e.fetchPhpfpmPoolStartTime(r,a,t,l,"sql");break;case"phpfpm_sql_max_active_proc":e.fetchPhpfpmPoolMacActiveProc(r,a,t,l,"sql");break;case"phpfpm_sql_proc_threshold_times":e.fetchPhpfpmPoolProcThresholdTimes(r,a,t,l,"sql");break;case"phpfpm_sql_process":e.fetchPhpfpmPoolProcess(r,a,t,l,"sql");break;case"phpfpm_sql_req_latency":e.fetchPhpfpmPoolReqLatency(r,a,t,l,"sql");break;case"phpfpm_sql_req_slow":e.fetchPhpfpmPoolReqSlow(r,a,t,l,"sql");break;case"backup_mysql_size":e.fetchBackupSize(r,a,t,l,"mysql_backup_");break;case"backup_wordpress_size":e.fetchBackupSize(r,a,t,l,"wordpress_backup_");break;case"backup_mysql_duration":e.fetchBackupDuration(r,a,t,l,"mysql_backup_");break;case"backup_wordpress_duration":e.fetchBackupDuration(r,a,t,l,"wordpress_backup_");break;case"backup_mysql_timestamp":e.fetchBackupTimestamp(r,a,t,l,"mysql_backup_");break;case"backup_wordpress_timestamp":e.fetchBackupTimestamp(r,a,t,l,"wordpress_backup_")}}))}))}},{key:"componentDidMount",value:function(){this.fetchData();setInterval(this.fetchData,5e3)}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){for(var e=[],t=0;t<this.state.chartDataArray.length;++t){for(var a=[],r=this.state.chartDataArray[t].chartConfigs,n=this.state.chartDataArray[t].panelTitle,i=0;i<r.length;++i){var s="col_"+t.toString()+"_"+i.toString(),o=r[i];if("line"===o.chartType){var c={xFieldName:this.state.xFieldName,yFieldName:this.state.yFieldName,seriesField:this.state.seriesField,pointsData:o.pointsData,title:o.title,desc:o.desc,yAxis:o.yAxis};a.push(l.a.createElement(f.a,{key:s,span:12},l.a.createElement(y.a,{title:o.title},o.loading?l.a.createElement(d.a,null,l.a.createElement(q,c)):l.a.createElement(q,c))))}if("bullet"===o.chartType){var p={data:o.pointsData,chartTitle:o.title,chartDesc:o.desc};a.push(l.a.createElement(f.a,{key:s,span:12},l.a.createElement(y.a,{title:o.title},o.loading?l.a.createElement(d.a,null,l.a.createElement(v,p)):l.a.createElement(v,p))))}if("liquid"===o.chartType){var u={desc:o.desc,curValue:0===o.pointsData.length?null:o.pointsData[o.pointsData.length-1].curValue,maxValue:0===o.pointsData.length?null:o.pointsData[o.pointsData.length-1].maxValue};a.push(l.a.createElement(f.a,{key:s,span:12},l.a.createElement(y.a,{title:o.title},o.loading?l.a.createElement(d.a,null,l.a.createElement(x,u)):l.a.createElement(x,u))))}if("statistics"===o.chartType){var h={desc:o.desc,value:0===o.pointsData.length?null:o.pointsData[o.pointsData.length-1].value};a.push(l.a.createElement(f.a,{key:s,span:12},l.a.createElement(y.a,{title:o.title},o.loading?l.a.createElement(d.a,null,l.a.createElement(P,h)):l.a.createElement(P,h))))}if("pie"===o.chartType){var _={title:o.title,desc:o.desc,data:0===o.pointsData.length?[]:o.pointsData};a.push(l.a.createElement(f.a,{key:s,span:12},l.a.createElement(y.a,{title:o.title},o.loading?l.a.createElement(d.a,null,l.a.createElement(j,_)):l.a.createElement(j,_))))}if("column"===o.chartType){var b={title:o.title,desc:o.desc,data:o.pointsData};a.push(l.a.createElement(f.a,{key:s,span:12},l.a.createElement(y.a,{title:o.title},o.loading?l.a.createElement(d.a,null,l.a.createElement(T,b)):l.a.createElement(T,b))))}}var k=this.rowIdx2Key(t);e.push(l.a.createElement(F,{header:n,key:k},l.a.createElement(g.a,{key:k,gutter:[16,16]},a)))}return l.a.createElement("div",null,l.a.createElement(m.a,{defaultActiveKey:[this.rowIdx2Key(0)],onChange:this.panelChanged},e))}}]),a}(l.a.Component);Date.prototype.Format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"H+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var a in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),t)new RegExp("("+a+")").test(e)&&(e=e.replace(RegExp.$1,1===RegExp.$1.length?t[a]:("00"+t[a]).substr((""+t[a]).length)));return e};var O=E,C=(l.a.Component,a(136)),S=function(e){Object(c.a)(a,e);var t=Object(p.a)(a);function a(e){var r;return Object(s.a)(this,a),(r=t.call(this,e)).state=r.state={xFieldName:"x",yFieldName:"y",seriesField:"type",chartDataArray:[{panelTitle:"Connections",chartConfigs:[{queryUrl:"http://metric.lgxzj.wiki/api/v1/query_range",pointsData:[],type:"mysql_conn_stats",chartType:"line",title:"MySQL \u8fde\u63a5\u72b6\u6001",desc:"\u6253\u5f00/\u5f53\u524d/\u6700\u5927/\u5cf0\u503c \u8fde\u63a5",yAxis:{visible:!0,min:0,max:400,tickCount:5},loading:!0},{queryUrl:"http://metric.lgxzj.wiki/api/v1/query_range",pointsData:[],type:"mysql_conn_err",chartType:"line",title:"MySQL \u8fde\u63a5\u9519\u8bef\u6570",desc:"MySQL\u8fde\u63a5\u9519\u8bef\uff0c\u6309\u9519\u8bef\u5206\u7c7b",yAxis:{visible:!0,min:0,max:400,tickCount:5},loading:!0}]},{panelTitle:"\u67e5\u8be2\u541e\u5410\u91cf",chartConfigs:[{queryUrl:"http://metric.lgxzj.wiki/api/v1/query_range",pointsData:[],type:"mysql_tps_qps",chartType:"line",title:"MySQL TPS/QPS Summary",desc:"TPS/QPS",loading:!0},{queryUrl:"http://metric.lgxzj.wiki/api/v1/query_range",pointsData:[],type:"mysql_command_qps",chartType:"line",title:"MySQL QPS By Command",desc:"\u6309\u547d\u4ee4\u5206\u7c7bQPS",loading:!0}]},{panelTitle:"\u67e5\u8be2\u6027\u80fd",chartConfigs:[{queryUrl:"http://metric.lgxzj.wiki/api/v1/query_range",pointsData:[],type:"mysql_query_slow",chartType:"line",title:"MySQL Slow Query",desc:"\u6162\u67e5\u8be2\u7387",loading:!0},{queryUrl:"http://metric.lgxzj.wiki/api/v1/query_range",pointsData:[],type:"mysql_slow_threshold",chartType:"liquid",maxValue:50,title:"MySQL \u6162\u67e5\u8be2\u9608\u503c",desc:"\u6162\u67e5\u8be2\u9608\u503c\uff0c\u5355\u4f4d\u55b5",loading:!0}]},{panelTitle:"InnoDB\u7f13\u5b58",chartConfigs:[{queryUrl:"http://metric.lgxzj.wiki/api/v1/query_range",pointsData:[],type:"mysql_buffer_pool_size",chartType:"statistics",title:"MySQL Buffer Pool Size",desc:"InnoDB\u7f13\u5b58\u6c60\u5927\u5c0f, \u5355\u4f4dKB",loading:!0},{queryUrl:"http://metric.lgxzj.wiki/api/v1/query_range",pointsData:[],type:"mysql_buffer_pool_page_size",chartType:"statistics",title:"MySQL Buffer Pool Page Size",desc:"InnoDB\u7f13\u5b58\u6c60\u9875\u9762\u5927\u5c0f, \u5355\u4f4dKB",loading:!0},{queryUrl:"http://metric.lgxzj.wiki/api/v1/query_range",pointsData:[],type:"mysql_buffer_pool_pages",chartType:"line",title:"MySQL Buffer Pool Pages",desc:"InnoDB\u7f13\u5b58\u6c60\u9875\u9762\u6570\uff0c\u6309\u7c7b\u578b\u5206\u7c7b",loading:!0},{queryUrl:"http://metric.lgxzj.wiki/api/v1/query_range",pointsData:[],type:"mysql_buffer_pool_hits",chartType:"line",title:"MySQL Buffer Pool Hit Status",desc:"InnoDB\u7f13\u5b58\u6c60\u9875\u9762\u547d\u4e2d\u72b6\u6001",loading:!0}]}]},r}return Object(o.a)(a,[{key:"render",value:function(){return l.a.createElement(O,this.state)}}]),a}(l.a.Component),M=function(e){Object(c.a)(a,e);var t=Object(p.a)(a);function a(e){var r;return Object(s.a)(this,a),(r=t.call(this,e)).state=r.state={xFieldName:"x",yFieldName:"y",seriesField:"type",chartDataArray:[{panelTitle:"Wordpress Blog Site",chartConfigs:[{queryUrl:"http://metric.lgxzj.wiki/api/v1/query",pointsData:[],type:"nginx_http_req_status_www.lgxzj.wiki",chartType:"pie",title:"www.lgxzj.wiki\u8bf7\u6c42\u54cd\u5e94\u5206\u5e03",desc:"",loading:!0}]},{panelTitle:"React Pages",chartConfigs:[{queryUrl:"http://metric.lgxzj.wiki/api/v1/query",pointsData:[],type:"nginx_http_req_status_metric.lgxzj.wiki",chartType:"pie",title:"metric.lgxzj.wiki\u8bf7\u6c42\u54cd\u5e94\u5206\u5e03",desc:"",loading:!0},{queryUrl:"http://metric.lgxzj.wiki/api/v1/query",pointsData:[],type:"nginx_http_req_status_react.lgxzj.wiki",chartType:"pie",title:"react.lgxzj.wiki\u8bf7\u6c42\u54cd\u5e94\u5206\u5e03",desc:"",loading:!0}]}]},r}return Object(o.a)(a,[{key:"render",value:function(){return l.a.createElement(O,this.state)}}]),a}(l.a.Component),B=function(e){Object(c.a)(a,e);var t=Object(p.a)(a);function a(e){var r;return Object(s.a)(this,a),(r=t.call(this,e)).state=r.state={xFieldName:"x",yFieldName:"y",seriesField:"type",chartDataArray:[{panelTitle:"Wordpress WorkerPool",chartConfigs:[{queryUrl:"http://metric.lgxzj.wiki/api/v1/query",pointsData:[],type:"phpfpm_wordpress_total_conns",chartType:"statistics",title:"Accepted Conns",desc:"\u7d2f\u8ba1\u8fde\u63a5\u6570",loading:!0},{queryUrl:"http://metric.lgxzj.wiki/api/v1/query",pointsData:[],type:"phpfpm_wordpress_start_time",chartType:"statistics",title:"Start Time",desc:"\u542f\u52a8\u65f6\u95f4\uff0c\u5355\u4f4d\u5206\u949f",loading:!0},{queryUrl:"http://metric.lgxzj.wiki/api/v1/query",pointsData:[],type:"phpfpm_wordpress_max_active_proc",chartType:"statistics",title:"\u6700\u5927\u5386\u53f2\u6d3b\u8dc3\u8fdb\u7a0b\u6570",desc:"",loading:!0},{queryUrl:"http://metric.lgxzj.wiki/api/v1/query",pointsData:[],type:"phpfpm_wordpress_proc_threshold_times",chartType:"statistics",title:"\u8fdb\u7a0bfork\u89e6\u9650\u6b21\u6570",desc:"",loading:!0},{queryUrl:"http://metric.lgxzj.wiki/api/v1/query_range",pointsData:[],type:"phpfpm_wordpress_process",chartType:"line",title:"\u8fdb\u7a0b\u6c60",desc:"\u8fdb\u7a0b\u6c60\u8fdb\u7a0b\u6570\u91cf\uff0c\u6309\u72b6\u6001\u5206\u7c7b",loading:!0},{queryUrl:"http://metric.lgxzj.wiki/api/v1/query_range",pointsData:[],type:"phpfpm_wordpress_req_latency",chartType:"line",title:"\u8bf7\u6c42\u8017\u65f6",desc:"\u5355\u4f4d\u6beb\u79d2",loading:!0},{queryUrl:"http://metric.lgxzj.wiki/api/v1/query_range",pointsData:[],type:"phpfpm_wordpress_req_slow",chartType:"statistics",title:"\u6162\u67e5\u8be2\u6b21\u6570",desc:"\u8d85\u8fc7request_slowlog_timeout\u8017\u65f6\u7684\u67e5\u8be2\u6b21\u6570",loading:!0}]},{panelTitle:"Sql WorkerPool",chartConfigs:[{queryUrl:"http://metric.lgxzj.wiki/api/v1/query",pointsData:[],type:"phpfpm_sql_total_conns",chartType:"statistics",title:"Accepted Conns",desc:"\u7d2f\u8ba1\u8fde\u63a5\u6570",loading:!0},{queryUrl:"http://metric.lgxzj.wiki/api/v1/query",pointsData:[],type:"phpfpm_sql_start_time",chartType:"statistics",title:"Start Time",desc:"\u542f\u52a8\u65f6\u95f4\uff0c\u5355\u4f4d\u5206\u949f",loading:!0},{queryUrl:"http://metric.lgxzj.wiki/api/v1/query",pointsData:[],type:"phpfpm_sql_max_active_proc",chartType:"statistics",title:"\u6700\u5927\u5386\u53f2\u6d3b\u8dc3\u8fdb\u7a0b\u6570",desc:"",loading:!0},{queryUrl:"http://metric.lgxzj.wiki/api/v1/query",pointsData:[],type:"phpfpm_sql_proc_threshold_times",chartType:"statistics",title:"\u8fdb\u7a0bfork\u89e6\u9650\u6b21\u6570",desc:"",loading:!0},{queryUrl:"http://metric.lgxzj.wiki/api/v1/query_range",pointsData:[],type:"phpfpm_sql_process",chartType:"line",title:"\u8fdb\u7a0b\u6c60",desc:"\u8fdb\u7a0b\u6c60\u8fdb\u7a0b\u6570\u91cf\uff0c\u6309\u72b6\u6001\u5206\u7c7b",loading:!0},{queryUrl:"http://metric.lgxzj.wiki/api/v1/query_range",pointsData:[],type:"phpfpm_sql_req_latency",chartType:"line",title:"\u8bf7\u6c42\u8017\u65f6",desc:"\u5355\u4f4d\u6beb\u79d2",loading:!0},{queryUrl:"http://metric.lgxzj.wiki/api/v1/query_range",pointsData:[],type:"phpfpm_sql_req_slow",chartType:"statistics",title:"\u6162\u67e5\u8be2\u6b21\u6570",desc:"\u8d85\u8fc7request_slowlog_timeout\u8017\u65f6\u7684\u67e5\u8be2\u6b21\u6570",loading:!0}]}]},r}return Object(o.a)(a,[{key:"render",value:function(){return l.a.createElement(O,this.state)}}]),a}(l.a.Component),I=function(e){Object(c.a)(a,e);var t=Object(p.a)(a);function a(e){var r;return Object(s.a)(this,a),(r=t.call(this,e)).state=r.state={xFieldName:"x",yFieldName:"y",seriesField:"type",chartDataArray:[{panelTitle:"Cpu & Mem"}]},r}return Object(o.a)(a,[{key:"render",value:function(){return l.a.createElement(O,this.state)}}]),a}(l.a.Component),U=function(e){Object(c.a)(a,e);var t=Object(p.a)(a);function a(e){var r;return Object(s.a)(this,a),(r=t.call(this,e)).state=r.state={xFieldName:"x",yFieldName:"y",seriesField:"type",chartDataArray:[{panelTitle:"Backups",chartConfigs:[{queryUrl:"http://metric.lgxzj.wiki/api/v1/query",pointsData:[],type:"backup_mysql_size",chartType:"column",title:"MySQL\u5907\u4efd\u5927\u5c0f",desc:"\u8fd1\u4e03\u65e5\u5907\u4efd\uff0c\u5355\u4f4dKB",loading:!0},{queryUrl:"http://metric.lgxzj.wiki/api/v1/query",pointsData:[],type:"backup_mysql_duration",chartType:"column",title:"MySQL\u5907\u4efd\u65f6\u957f",desc:"\u8fd1\u4e03\u65e5\u5907\u4efd\u8017\u65f6\uff0c\u5355\u4f4d\u6beb\u79d2",loading:!0}]},{panelTitle:"Backups",chartConfigs:[{queryUrl:"http://metric.lgxzj.wiki/api/v1/query",pointsData:[],type:"backup_wordpress_size",chartType:"column",title:"Wordpress\u5907\u4efd\u5927\u5c0f",desc:"\u8fd1\u4e03\u65e5\u5907\u4efd\uff0c\u5355\u4f4dKB",loading:!0},{queryUrl:"http://metric.lgxzj.wiki/api/v1/query",pointsData:[],type:"backup_wordpress_duration",chartType:"column",title:"Wordpress\u5907\u4efd\u65f6\u957f",desc:"\u8fd1\u4e03\u65e5\u5907\u4efd\u8017\u65f6\uff0c\u5355\u4f4d\u6beb\u79d2",loading:!0}]}]},r}return Object(o.a)(a,[{key:"render",value:function(){return l.a.createElement(O,this.state)}}]),a}(l.a.Component),N=(l.a.Component,C.a.TabPane),Q=function(e){Object(c.a)(a,e);var t=Object(p.a)(a);function a(e){var r;return Object(s.a)(this,a),(r=t.call(this,e)).state={dataConfigs:[{tabTitle:"MySQL"},{tabTitle:"Nginx"},{tabTitle:"PHP-FPM"},{tabTitle:"Backups"}]},r}return Object(o.a)(a,[{key:"onTabChange",value:function(){}},{key:"title2Component",value:function(e){switch(e){case"MySQL":return l.a.createElement(S,null);case"Nginx":return l.a.createElement(M,null);case"PHP-FPM":return l.a.createElement(B,null);case"Prometheus":return l.a.createElement(I,null);case"Backups":return l.a.createElement(U,null);default:throw"unexpected title:"+e}}},{key:"tabPaneKey",value:function(e){return"key_"+e.toString()}},{key:"render",value:function(){var e=this,t=[];return this.state.dataConfigs.forEach((function(a,r){t.push(l.a.createElement(N,{tab:a.tabTitle,key:e.tabPaneKey(r)},e.title2Component(a.tabTitle)))})),l.a.createElement(C.a,{defaultActiveKey:this.tabPaneKey(0),onChange:this.onTabChange,type:"card",centered:!0},t)}}]),a}(l.a.Component);var A=function(){return l.a.createElement(Q,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(A,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[212,1,2]]]);
//# sourceMappingURL=main.3b6c0dd6.chunk.js.map